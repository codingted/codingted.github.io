---
title: Vim运行外部命令
tags: Linux Vim
---


在Vim可以通过在`密令模式下`运行`:shell`和`sh`进入终端,通过`exit`退出终端重新回到Vim会话.

在*nix系统中可以通过`Ctrl-z`將vim放入后台运行,然后通过`fg`命令,將Vim切换到前台.

## Bang!

Vim允许直接在Vim的`命令模式`下执行命令,格式`:! commond`,例如如果你先统计当前编辑的文件的字数:

```shell
:! wc %
// % 代表当前的文件
```

`!`被用来执行非交互的命令.如果你需要运行`top`之类的命令,使用这种方式也是可以的,但是还是使用`:sh`或者是`Ctrl-z`方式执行.

`!`命令可以非常方便的执行脚本程序.`:! python %`,可以在写脚本程序时定时的检查脚本程序,在Vim命令模式下可以使用`上下箭头`来切换历史命令.
可以使用`:!!`来执行最近一次执行的命令.


## 读入命令输出

* 使用Vim读入命令来插入文本到当前的编辑窗口,例如:`:r textfile`.
* 读入命令的输出,如果需要將目录下的文件详细信息输入到当前的编辑窗口可以使用:`:r ! ls -l /dir`
* 读入网页可以使用`w3m`命令来获取网页的文字版`:r !w3m url -dump`(`-dump`选项告诉w3m以文本方式输出并退出)
* 读入指定的文本行`:r ! grep *string* /error/log/file.log`
* 指定特定的行进行替换/过滤:`:20,23 ! commond`
