
JMM 

顺序一致性模型 通过synchronized关键字保证对外的可见性


1. 顺序一致性模型保证单线程内的操作会按程序的顺序执行,而 JMM 不保证单
线程内的操作会按程序的顺序执行(比如上面正确同步的多线程程序在临界区
内的重排序)。这一点前面已经讲过了,这里就不再赘述。
2. 顺序一致性模型保证所有线程只能看到一致的操作执行顺序,而 JMM 不保证
所有线程能看到一致的操作执行顺序。这一点前面也已经讲过,这里就不再赘
述。
3. JMM 不保证对 64 位的 long 型和 double 型变量的读/写操作具有原子性,而
顺序一致性模型保证对所有的内存读/写操作都具有原子性。



在每个 volatile 写操作的前面插入一个 StoreStore 屏障。
在每个 volatile 写操作的后面插入一个 StoreLoad 屏障。
在每个 volatile 读操作的后面插入一个 LoadLoad 屏障。
在每个 volatile 读操作的后面插入一个 LoadStore 屏障。



